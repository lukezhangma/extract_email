Validity: Microservice That Transforms Email Message 
==========================================================================

This project contains two directories, such as:
`k8s`,`web`

`k8s` contains ansible scripts that are used for deploying service on AWS EKS service. Unfortuately, I never have time to configure 'minikube' on my computer.
`web` contains a Django Web project which can be dockerized to run on your local desktop or on cloud.


Installation:
-------------

First method, go to `web` directory, run the web server(Python, Django required):
```sh
1. You could start web server from `web/validity` directory by running(assuming Python and Django are installed):
2. python ./manage.py runserver
```
Then you could use Http client software, `curl` or `Nightingale` to test the web service:
The url is `http://localhost:8000/email/`
```sh
1. curl -X POST -d <email  message> http://localhost:8000/email/
```

Second way is to dockerize the web service by(I assume you already have `docker` installed):
```sh
1. $ docker build -t validity .
2. You could run the image on your local machine by:
3. $ docker run --name email -p 8000:8000 -d validity
```

Third way is to go to `k8s` directory, run playbook to deploy it on AWS EKS,
we assume you have build docker image and push it to ECR service:
```sh
1. $ ansible-playbook deploy-email-service.yml
```

Explanation of Each File
---------------------------

Files in web service directoiry are mostly generated by using Django commands.
I won't go into details to set up the web service, you could read Django document for details.
I will explain the files that written by me:
```ini
[web/Dockerfile]
For building docker image of web service.
```

```ini
[web/requirements.txt]
Contains dependency software for web service to be installed in container.
```

```ini
[web/validity/process_email]
This is the directory containing REST serviceof email application, where when a POST request is called from client, this application respond to the request.
```

```ini
[web/validity/process_email/views.py]
Where POST method is defined
```

```ini
[web/validity/email_processor.py]
This module contains function that extract required info from input mesage by
using Python regular expression package.
```

```ini
[web/validity/email_template.py]
The template with regualar expression pattern that match the info in emails
```
```ini
[web/validity/extract_email_info.py]
The function that is called to convert email messaged to response message.
From this file the function of matching regular expression is called.
```


Next I will explain file for deploying to  `AWS EKS`:

```ini
[k8s/deploy-email-service.yml]
Top level of playbook that will deploy email service to k8s.
```

```ini
[k8s/roles/initialization/defaults/main.yml]
Input parameters of AWS EKS services.
```

```ini
[k8s/roles/deploy-service/tasks/configure-service.yml]
Where k8s module of ansible is called to deploy service.
```

```ini
[k8s/roles/deploy-service/template/emailservice.ym.j2]
The specification and definition of deployment of pod of email container service. 
```

Test of Web Services
---------------------------
All value of given input messages are tested successfully.